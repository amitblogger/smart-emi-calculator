<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Smart EMI Calculator - Calculate loan EMIs with charts, dark mode, and PDF export.">
  <title>Smart EMI Calculator â€“ Demo</title>
  <style>
    /* === Inline CSS from style.css === */
    :root {
      --bg-color: #ffffff;
      --text-color: #222222;
      --primary-color: #007bff;
      --card-color: #f9f9f9;
      --accent-color: #007bff;
      --border-radius: 12px;
    }
    body.dark-mode {
      --bg-color: #1e1e1e;
      --text-color: #eeeeee;
      --card-color: #2a2a2a;
      --accent-color: #66aaff;
    }
    body {
      margin: 0;
      background-color: var(--bg-color);
      color: var(--text-color);
      font-family: 'Segoe UI', sans-serif;
      transition: background 0.3s ease, color 0.3s ease;
    }
    .emi-calculator-container {
      max-width: 800px;
      margin: 2rem auto;
      padding: 1.5rem;
      background-color: var(--card-color);
      color: var(--text-color);
      border-radius: var(--border-radius);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }
    .emi-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.2rem;
    }
    .emi-header h2 {
      font-size: 1.8rem;
      margin: 0;
    }
    #theme-toggle {
      font-size: 1.3rem;
      padding: 6px 12px;
      cursor: pointer;
      border: none;
      border-radius: 8px;
      background-color: var(--accent-color);
      color: white;
    }
    .emi-inputs label {
      display: block;
      margin: 1rem 0;
      font-weight: 600;
    }
    .emi-inputs input[type="range"] {
      width: 100%;
      margin-top: 5px;
    }
    .emi-inputs span {
      display: inline-block;
      margin-left: 10px;
      font-weight: bold;
    }
    .emi-inputs select {
      padding: 8px;
      margin-top: 5px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    #calculate-btn, #download-pdf {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 10px 20px;
      font-weight: bold;
      border-radius: 8px;
      margin-top: 1rem;
      cursor: pointer;
    }
    .emi-results {
      margin-top: 2rem;
      text-align: center;
    }
    .emi-results h3 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
    }
    canvas#emi-chart {
      margin: 1.5rem auto;
      display: block;
      max-width: 100%;
    }
  </style>
</head>
<body>
  <div class="emi-calculator-container">
    <div class="emi-header">
      <h2>ðŸ“Š Smart EMI Calculator</h2>
      <button id="theme-toggle">ðŸŒ“</button>
    </div>

    <div class="emi-inputs">
      <label>Loan Amount (<span id="currency-symbol">â‚¹</span>): 
        <input type="range" id="loan-amount" min="10000" max="10000000" step="1000" value="500000">
        <span id="loan-amount-val">500000</span>
      </label>

      <label>Interest Rate (% per annum): 
        <input type="range" id="interest-rate" min="1" max="20" step="0.1" value="8.5">
        <span id="interest-rate-val">8.5</span>
      </label>

      <label>Loan Tenure (in months): 
        <input type="range" id="loan-tenure" min="6" max="360" step="6" value="120">
        <span id="loan-tenure-val">120</span>
      </label>

      <label>Select Currency: 
        <select id="currency-select">
          <option value="â‚¹">INR (â‚¹)</option>
          <option value="$">USD ($)</option>
          <option value="Â£">GBP (Â£)</option>
          <option value="â‚¬">EUR (â‚¬)</option>
        </select>
      </label>

      <button id="calculate-btn">Calculate EMI</button>
    </div>

    <div class="emi-results">
      <h3>ðŸ“‹ EMI Details</h3>
      <p><strong>Monthly EMI:</strong> <span id="monthly-emi">-</span></p>
      <p><strong>Total Interest Payable:</strong> <span id="total-interest">-</span></p>
      <p><strong>Total Payment (Principal + Interest):</strong> <span id="total-payment">-</span></p>
      <canvas id="emi-chart" width="300" height="300"></canvas>
      <button id="download-pdf">ðŸ“„ Export to PDF</button>
    </div>
  </div>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const loanAmount = document.getElementById('loan-amount');
      const interestRate = document.getElementById('interest-rate');
      const loanTenure = document.getElementById('loan-tenure');
      const calculateBtn = document.getElementById('calculate-btn');
      const currencySelect = document.getElementById('currency-select');

      const loanVal = document.getElementById('loan-amount-val');
      const interestVal = document.getElementById('interest-rate-val');
      const tenureVal = document.getElementById('loan-tenure-val');
      const currencySymbol = document.getElementById('currency-symbol');

      const monthlyEMI = document.getElementById('monthly-emi');
      const totalInterest = document.getElementById('total-interest');
      const totalPayment = document.getElementById('total-payment');

      const chartCanvas = document.getElementById('emi-chart');
      const themeToggle = document.getElementById('theme-toggle');
      const downloadBtn = document.getElementById('download-pdf');

      let emiChart;

      loanAmount.oninput = () => loanVal.textContent = loanAmount.value;
      interestRate.oninput = () => interestVal.textContent = interestRate.value;
      loanTenure.oninput = () => tenureVal.textContent = loanTenure.value;

      currencySelect.onchange = () => {
        currencySymbol.textContent = currencySelect.value;
      };

      calculateBtn.onclick = () => {
        const P = parseFloat(loanAmount.value);
        const annualRate = parseFloat(interestRate.value);
        const N = parseInt(loanTenure.value);

        const R = annualRate / 12 / 100;
        const EMI = (P * R * Math.pow(1 + R, N)) / (Math.pow(1 + R, N) - 1);
        const total = EMI * N;
        const interest = total - P;

        const symbol = currencySelect.value;

        monthlyEMI.textContent = `${symbol} ${EMI.toFixed(2)}`;
        totalInterest.textContent = `${symbol} ${interest.toFixed(2)}`;
        totalPayment.textContent = `${symbol} ${total.toFixed(2)}`;

        if (emiChart) emiChart.destroy();
        emiChart = new Chart(chartCanvas, {
          type: 'pie',
          data: {
            labels: ['Principal', 'Interest'],
            datasets: [{
              data: [P, interest],
              backgroundColor: ['#007bff', '#ffc107']
            }]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { position: 'bottom' }
            }
          }
        });
      };

      themeToggle.onclick = () => {
        document.body.classList.toggle('dark-mode');
      };

      downloadBtn.onclick = () => {
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF();
        const symbol = currencySelect.value;

        pdf.setFontSize(16);
        pdf.text("Loan EMI Report", 70, 20);
        pdf.setFontSize(12);
        pdf.text(`Loan Amount: ${symbol} ${loanAmount.value}`, 20, 40);
        pdf.text(`Interest Rate: ${interestRate.value}%`, 20, 50);
        pdf.text(`Tenure: ${loanTenure.value} months`, 20, 60);
        pdf.text(`Monthly EMI: ${monthlyEMI.textContent}`, 20, 80);
        pdf.text(`Total Interest: ${totalInterest.textContent}`, 20, 90);
        pdf.text(`Total Payment: ${totalPayment.textContent}`, 20, 100);

        pdf.save("emi-report.pdf");
      };
    });
  </script>
</body>
</html>
